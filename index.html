<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Perfume Price Hunter</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --ink: #0e0c0a;
    --cream: #f5f0e8;
    --gold: #b8922a;
    --gold-light: #e8c96a;
    --amber: #d4791a;
    --muted: #8a8070;
    --border: rgba(184,146,42,0.25);
    --glass: rgba(245,240,232,0.6);
  }

  body {
    background: var(--ink);
    color: var(--cream);
    font-family: 'DM Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
  }

  /* Atmospheric background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 80% 50% at 20% -10%, rgba(184,146,42,0.12) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 85% 100%, rgba(212,121,26,0.08) 0%, transparent 50%),
      radial-gradient(ellipse 100% 80% at 50% 50%, rgba(14,12,10,0.4) 0%, transparent 100%);
    pointer-events: none;
    z-index: 0;
  }

  /* Noise texture */
  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
    opacity: 0.6;
  }

  #root { position: relative; z-index: 1; }

  .app {
    max-width: 900px;
    margin: 0 auto;
    padding: 60px 24px 100px;
  }

  /* Header */
  .header {
    text-align: center;
    margin-bottom: 64px;
  }

  .eyebrow {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 0.3em;
    color: var(--gold);
    text-transform: uppercase;
    margin-bottom: 16px;
    opacity: 0;
    animation: fadeUp 0.6s 0.1s forwards;
  }

  .title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(48px, 8vw, 86px);
    font-weight: 300;
    line-height: 0.9;
    letter-spacing: -0.02em;
    color: var(--cream);
    opacity: 0;
    animation: fadeUp 0.7s 0.2s forwards;
  }

  .title em {
    font-style: italic;
    color: var(--gold-light);
  }

  .subtitle {
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 0.08em;
    margin-top: 20px;
    opacity: 0;
    animation: fadeUp 0.7s 0.35s forwards;
  }

  /* Divider */
  .divider {
    display: flex;
    align-items: center;
    gap: 16px;
    margin: 32px 0;
    opacity: 0;
    animation: fadeUp 0.6s 0.4s forwards;
  }
  .divider::before, .divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
  }
  .divider-icon {
    font-size: 18px;
    color: var(--gold);
    opacity: 0.7;
  }

  /* Search */
  .search-section {
    opacity: 0;
    animation: fadeUp 0.7s 0.5s forwards;
  }

  .search-wrap {
    position: relative;
    display: flex;
    gap: 0;
  }

  .search-input {
    flex: 1;
    background: rgba(245,240,232,0.04);
    border: 1px solid var(--border);
    border-right: none;
    border-radius: 4px 0 0 4px;
    padding: 18px 24px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    font-weight: 300;
    color: var(--cream);
    outline: none;
    transition: border-color 0.3s, background 0.3s;
    letter-spacing: 0.02em;
  }

  .search-input::placeholder { color: rgba(245,240,232,0.25); }

  .search-input:focus {
    border-color: var(--gold);
    background: rgba(184,146,42,0.05);
  }

  .search-btn {
    background: var(--gold);
    border: 1px solid var(--gold);
    border-radius: 0 4px 4px 0;
    padding: 18px 32px;
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--ink);
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
    white-space: nowrap;
  }

  .search-btn:hover:not(:disabled) { background: var(--gold-light); }
  .search-btn:active:not(:disabled) { transform: scale(0.98); }
  .search-btn:disabled { opacity: 0.5; cursor: not-allowed; }

  /* Sites config */
  .sites-config {
    margin-top: 20px;
    padding: 16px 20px;
    border: 1px solid var(--border);
    border-radius: 4px;
    background: rgba(245,240,232,0.02);
  }

  .sites-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    user-select: none;
  }

  .sites-label {
    font-size: 10px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .sites-toggle {
    font-size: 10px;
    color: var(--gold);
    letter-spacing: 0.1em;
  }

  .sites-list {
    margin-top: 14px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .site-chip {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 14px;
    border: 1px solid var(--border);
    border-radius: 2px;
    font-size: 11px;
    letter-spacing: 0.08em;
    cursor: pointer;
    transition: all 0.2s;
    background: transparent;
    color: var(--muted);
  }

  .site-chip.active {
    border-color: var(--gold);
    color: var(--gold-light);
    background: rgba(184,146,42,0.08);
  }

  .site-chip-dot {
    width: 5px; height: 5px;
    border-radius: 50%;
    background: currentColor;
    flex-shrink: 0;
  }

  .add-site-row {
    margin-top: 10px;
    display: flex;
    gap: 8px;
  }

  .add-site-input {
    flex: 1;
    background: transparent;
    border: 1px dashed rgba(184,146,42,0.2);
    border-radius: 2px;
    padding: 6px 12px;
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    color: var(--cream);
    outline: none;
  }
  .add-site-input::placeholder { color: rgba(245,240,232,0.2); }
  .add-site-input:focus { border-color: var(--gold); }

  .add-site-btn {
    background: transparent;
    border: 1px dashed rgba(184,146,42,0.3);
    border-radius: 2px;
    padding: 6px 14px;
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--gold);
    cursor: pointer;
    transition: all 0.2s;
  }
  .add-site-btn:hover { border-color: var(--gold); background: rgba(184,146,42,0.08); }

  /* Loading */
  .loading-state {
    text-align: center;
    padding: 80px 0;
  }

  .loading-orb {
    width: 60px; height: 60px;
    margin: 0 auto 28px;
    border-radius: 50%;
    border: 1px solid var(--border);
    border-top-color: var(--gold);
    animation: spin 1.2s linear infinite;
    position: relative;
  }

  .loading-orb::after {
    content: '◈';
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    font-size: 20px;
    color: var(--gold);
    animation: spin 1.2s linear infinite reverse;
  }

  .loading-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 22px;
    font-weight: 300;
    font-style: italic;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .loading-sub {
    font-size: 10px;
    letter-spacing: 0.2em;
    color: rgba(138,128,112,0.5);
  }

  /* Results */
  .results-header {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    margin-bottom: 32px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }

  .results-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 32px;
    font-weight: 300;
  }

  .results-title span {
    font-style: italic;
    color: var(--gold-light);
  }

  .results-count {
    font-size: 10px;
    letter-spacing: 0.2em;
    color: var(--muted);
  }

  /* Best deal badge */
  .best-deal-banner {
    background: linear-gradient(135deg, rgba(184,146,42,0.15), rgba(212,121,26,0.1));
    border: 1px solid rgba(184,146,42,0.4);
    border-radius: 4px;
    padding: 14px 20px;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 14px;
    font-size: 12px;
  }

  .best-deal-icon { font-size: 20px; }

  .best-deal-label {
    font-size: 9px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 2px;
  }

  .best-deal-info {
    color: var(--cream);
    font-family: 'Cormorant Garamond', serif;
    font-size: 16px;
    font-weight: 300;
  }

  /* Table */
  .table-wrap {
    overflow-x: auto;
    border: 1px solid var(--border);
    border-radius: 4px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }

  thead tr {
    background: rgba(184,146,42,0.07);
    border-bottom: 1px solid var(--border);
  }

  th {
    padding: 14px 18px;
    text-align: left;
    font-size: 9px;
    font-weight: 500;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--muted);
    white-space: nowrap;
  }

  th.num { text-align: right; }

  tbody tr {
    border-bottom: 1px solid rgba(184,146,42,0.08);
    transition: background 0.15s;
  }

  tbody tr:last-child { border-bottom: none; }
  tbody tr:hover { background: rgba(184,146,42,0.04); }

  tbody tr.best-row { background: rgba(184,146,42,0.07); }

  td {
    padding: 14px 18px;
    color: var(--cream);
    vertical-align: middle;
  }

  td.num {
    text-align: right;
    font-variant-numeric: tabular-nums;
  }

  .store-name {
    font-family: 'Cormorant Garamond', serif;
    font-size: 15px;
    font-weight: 400;
  }

  .size-badge {
    display: inline-block;
    padding: 2px 8px;
    border: 1px solid var(--border);
    border-radius: 2px;
    font-size: 10px;
    letter-spacing: 0.08em;
    color: var(--muted);
  }

  .price {
    font-size: 14px;
    font-weight: 500;
    color: var(--cream);
  }

  .price-per-ml {
    font-size: 11px;
    color: var(--muted);
  }

  .best-label {
    font-size: 8px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gold);
    background: rgba(184,146,42,0.12);
    border: 1px solid rgba(184,146,42,0.3);
    padding: 2px 7px;
    border-radius: 2px;
    margin-left: 8px;
  }

  .link-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border: 1px solid var(--border);
    border-radius: 2px;
    font-size: 9px;
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gold);
    text-decoration: none;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .link-btn:hover {
    border-color: var(--gold);
    background: rgba(184,146,42,0.1);
  }

  .no-data { color: var(--muted); font-style: italic; font-size: 11px; }

  /* Error */
  .error-state {
    text-align: center;
    padding: 60px 0;
  }

  .error-icon { font-size: 36px; margin-bottom: 16px; }

  .error-msg {
    font-family: 'Cormorant Garamond', serif;
    font-size: 22px;
    font-weight: 300;
    color: var(--muted);
  }

  /* Notes / disclaimer */
  .note {
    margin-top: 24px;
    padding: 14px 20px;
    border-left: 2px solid var(--border);
    font-size: 11px;
    color: var(--muted);
    line-height: 1.7;
  }

  /* Footer */
  .footer {
    margin-top: 80px;
    text-align: center;
    font-size: 9px;
    letter-spacing: 0.2em;
    color: rgba(138,128,112,0.35);
    text-transform: uppercase;
  }

  /* Animations */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(18px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .fade-in {
    animation: fadeUp 0.5s forwards;
  }

  /* Responsive */
  @media (max-width: 600px) {
    .search-wrap { flex-direction: column; }
    .search-input { border-right: 1px solid var(--border); border-radius: 4px 4px 0 0; border-bottom: none; }
    .search-btn { border-radius: 0 0 4px 4px; text-align: center; }
  }
</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

// ─── CONFIGURACIÓN DE SITIOS ─────────────────────────────────────────────────
const DEFAULT_SITES = [
  { id: 'rouge',    name: 'Rouge Beauté',       url: 'perfumeriasrouge.com',     active: true  },
  { id: 'farma',    name: 'Farmacias del Pueblo',url: 'farmaciasdelpueblo.com.ar',active: true  },
  { id: 'lymage',   name: 'Lymage',              url: 'lymage.com.ar',            active: true  },
  { id: 'parfum',   name: 'Parfumerie',          url: 'parfumerie.com.ar',        active: true  },
  { id: 'meli',     name: 'MercadoLibre',        url: 'mercadolibre.com.ar',      active: true  },
];

// ─── PROMPT PARA CLAUDE API ───────────────────────────────────────────────────
function buildPrompt(perfume, sites) {
  const siteList = sites.filter(s => s.active).map(s => `- ${s.name} (${s.url})`).join('\n');
  return `You are a perfume price assistant for Argentina. The user is searching for: "${perfume}"

Return ONLY a raw JSON object. No markdown, no backticks, no explanation. Just the JSON.

Use this exact structure:
{"perfumeName":"official name","brand":"brand name","results":[{"store":"store name","url":"https://site.com","size_ml":100,"price_ars":183150,"available":true}],"notes":"optional note"}

Sites to check:
${siteList}

Rules:
- price_ars must be a plain number with no dots, commas or currency symbols (e.g. 183150 not $183.150)
- size_ml must be a plain integer (e.g. 100)
- available must be true or false
- If price is unknown, set price_ars to null and available to false
- Use approximate prices based on Argentine market knowledge 2025/2026
- Include one entry per store per size
- The response must start with { and end with } and be valid JSON`;
}

// ─── ROBUST JSON EXTRACTOR ───────────────────────────────────────────────────
function extractJSON(text) {
  // 1. Strip markdown code fences
  let clean = text.replace(/```json\s*/gi, '').replace(/```\s*/g, '').trim();

  // 2. Try to find the outermost { ... }
  const start = clean.indexOf('{');
  const end = clean.lastIndexOf('}');
  if (start !== -1 && end !== -1 && end > start) {
    clean = clean.slice(start, end + 1);
  }

  // 3. Try direct parse
  try { return JSON.parse(clean); } catch (_) {}

  // 4. Fix common issues: trailing commas before } or ]
  const fixed = clean
    .replace(/,\s*([}\]])/g, '$1')   // trailing commas
    .replace(/(['"])?([a-zA-Z0-9_]+)(['"])?\s*:/g, '"$2":') // unquoted keys
    .replace(/:\s*'([^']*)'/g, ':"$1"'); // single-quoted values

  return JSON.parse(fixed); // let it throw if still broken
}

// ─── LLAMADA A CLAUDE API ─────────────────────────────────────────────────────
async function searchPerfumePrices(perfume, sites) {
  const response = await fetch("https://api.anthropic.com/v1/messages", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      model: "claude-sonnet-4-20250514",
      max_tokens: 1500,
      messages: [{ role: "user", content: buildPrompt(perfume, sites) }]
    })
  });

  if (!response.ok) {
    const err = await response.json().catch(() => ({}));
    throw new Error(err?.error?.message || `HTTP ${response.status}`);
  }

  const data = await response.json();
  const text = data.content?.map(b => b.text || '').join('') || '';

  try {
    return extractJSON(text);
  } catch (parseErr) {
    console.error('Raw API response:', text);
    throw new Error(`No se pudo interpretar la respuesta. Respuesta cruda: ${text.slice(0, 200)}...`);
  }
}

// ─── FORMATTERS ───────────────────────────────────────────────────────────────
const fmt = (n) => n != null ? `$${n.toLocaleString('es-AR')}` : '—';
const fmtMl = (price, ml) => price && ml ? `$${Math.round(price / ml).toLocaleString('es-AR')}/ml` : '—';

// ─── COMPONENTES ─────────────────────────────────────────────────────────────

function SiteChip({ site, onToggle }) {
  return (
    <div className={`site-chip ${site.active ? 'active' : ''}`} onClick={() => onToggle(site.id)}>
      <div className="site-chip-dot" />
      {site.name}
    </div>
  );
}

function ResultsTable({ data }) {
  const rows = data.results.filter(r => r.available !== false || r.price_ars != null);
  const available = rows.filter(r => r.price_ars != null);
  
  // Mejor precio por ml
  let bestId = null;
  if (available.length > 0) {
    bestId = available.reduce((best, r) => {
      const pml = r.price_ars / r.size_ml;
      const bpml = best.price_ars / best.size_ml;
      return pml < bpml ? r : best;
    });
  }

  return (
    <div className="fade-in">
      <div className="results-header">
        <div className="results-title">
          <span>{data.brand}</span> · {data.perfumeName}
        </div>
        <div className="results-count">{rows.length} resultados</div>
      </div>

      {bestId && (
        <div className="best-deal-banner">
          <div className="best-deal-icon">✦</div>
          <div>
            <div className="best-deal-label">Mejor precio por ml</div>
            <div className="best-deal-info">
              {bestId.store} · {bestId.size_ml}ml · {fmt(bestId.price_ars)} · {fmtMl(bestId.price_ars, bestId.size_ml)}
            </div>
          </div>
        </div>
      )}

      <div className="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Tienda</th>
              <th>Tamaño</th>
              <th className="num">Precio</th>
              <th className="num">Precio / ml</th>
              <th>Link</th>
            </tr>
          </thead>
          <tbody>
            {rows.sort((a,b) => (a.price_ars||Infinity) - (b.price_ars||Infinity)).map((r, i) => {
              const isBest = bestId && r === bestId;
              return (
                <tr key={i} className={isBest ? 'best-row' : ''}>
                  <td>
                    <span className="store-name">{r.store}</span>
                    {isBest && <span className="best-label">✦ Mejor/ml</span>}
                  </td>
                  <td>
                    {r.size_ml
                      ? <span className="size-badge">{r.size_ml} ml</span>
                      : <span className="no-data">—</span>
                    }
                  </td>
                  <td className="num">
                    {r.price_ars
                      ? <span className="price">{fmt(r.price_ars)}</span>
                      : <span className="no-data">sin datos</span>
                    }
                  </td>
                  <td className="num">
                    <span className="price-per-ml">{fmtMl(r.price_ars, r.size_ml)}</span>
                  </td>
                  <td>
                    <a href={r.url} target="_blank" rel="noopener noreferrer" className="link-btn">
                      Ver → 
                    </a>
                  </td>
                </tr>
              );
            })}
          </tbody>
        </table>
      </div>

      {data.notes && (
        <div className="note">
          <strong>Nota:</strong> {data.notes}
        </div>
      )}

      <div className="note" style={{marginTop: 12}}>
        Los precios son orientativos basados en datos disponibles. Se recomienda verificar en cada sitio antes de comprar.
      </div>
    </div>
  );
}

// ─── APP PRINCIPAL ────────────────────────────────────────────────────────────
function App() {
  const [query, setQuery] = useState('');
  const [sites, setSites] = useState(DEFAULT_SITES);
  const [showSites, setShowSites] = useState(false);
  const [newSiteName, setNewSiteName] = useState('');
  const [newSiteUrl, setNewSiteUrl] = useState('');
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);
  const [error, setError] = useState(null);
  const inputRef = useRef(null);

  const toggleSite = (id) => {
    setSites(prev => prev.map(s => s.id === id ? {...s, active: !s.active} : s));
  };

  const addSite = () => {
    if (!newSiteName.trim() || !newSiteUrl.trim()) return;
    setSites(prev => [...prev, {
      id: Date.now().toString(),
      name: newSiteName.trim(),
      url: newSiteUrl.trim(),
      active: true
    }]);
    setNewSiteName('');
    setNewSiteUrl('');
  };

  const handleSearch = async () => {
    if (!query.trim()) return;
    setLoading(true);
    setResult(null);
    setError(null);
    try {
      const data = await searchPerfumePrices(query.trim(), sites);
      setResult(data);
    } catch (e) {
      setError('No se pudo obtener los resultados. Por favor, intentá de nuevo.');
      console.error(e);
    } finally {
      setLoading(false);
    }
  };

  const handleKey = (e) => {
    if (e.key === 'Enter') handleSearch();
  };

  const activeSites = sites.filter(s => s.active);

  return (
    <div className="app">
      {/* Header */}
      <div className="header">
        <div className="eyebrow">Comparador de precios · Argentina</div>
        <h1 className="title">Perfume<br /><em>Price Hunter</em></h1>
        <p className="subtitle">Buscá · Compará · Elegí el mejor precio</p>
      </div>

      <div className="divider">
        <div className="divider-icon">◈</div>
      </div>

      {/* Search */}
      <div className="search-section">
        <div className="search-wrap">
          <input
            ref={inputRef}
            className="search-input"
            type="text"
            placeholder="Ej: 212 Men Carolina Herrera, Sauvage Dior, Chanel N°5..."
            value={query}
            onChange={e => setQuery(e.target.value)}
            onKeyDown={handleKey}
          />
          <button
            className="search-btn"
            onClick={handleSearch}
            disabled={loading || !query.trim() || activeSites.length === 0}
          >
            {loading ? '...' : 'Buscar'}
          </button>
        </div>

        {/* Sites config */}
        <div className="sites-config">
          <div className="sites-header" onClick={() => setShowSites(v => !v)}>
            <span className="sites-label">
              Sitios activos: {activeSites.length}/{sites.length}
            </span>
            <span className="sites-toggle">{showSites ? '▲ ocultar' : '▼ configurar'}</span>
          </div>

          {showSites && (
            <>
              <div className="sites-list">
                {sites.map(s => (
                  <SiteChip key={s.id} site={s} onToggle={toggleSite} />
                ))}
              </div>
              <div className="add-site-row">
                <input
                  className="add-site-input"
                  placeholder="Nombre del sitio"
                  value={newSiteName}
                  onChange={e => setNewSiteName(e.target.value)}
                  style={{maxWidth: 160}}
                />
                <input
                  className="add-site-input"
                  placeholder="dominio.com.ar"
                  value={newSiteUrl}
                  onChange={e => setNewSiteUrl(e.target.value)}
                />
                <button className="add-site-btn" onClick={addSite}>+ Agregar</button>
              </div>
            </>
          )}
        </div>
      </div>

      {/* States */}
      <div style={{marginTop: 48}}>
        {loading && (
          <div className="loading-state">
            <div className="loading-orb" />
            <div className="loading-text">Buscando en {activeSites.length} sitios...</div>
            <div className="loading-sub">Consultando precios · comparando opciones</div>
          </div>
        )}

        {error && !loading && (
          <div className="error-state">
            <div className="error-icon">◌</div>
            <div className="error-msg">{error}</div>
          </div>
        )}

        {result && !loading && (
          <ResultsTable data={result} />
        )}
      </div>

      <div className="footer">
        Perfume Price Hunter · Powered by Claude AI · Argentina 2026
      </div>
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
